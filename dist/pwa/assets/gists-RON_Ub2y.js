import{bl as Q,bm as B,bn as It,bo as N,bp as q,bq as J,br as K,bs as Y,bt as H,bu as Z,bv as F,bw as tt,bx as et,by as st,bz as Wt,bA as at,bB as rt,bC as it,bD as nt,bE as lt,bF as ct,bG as ot,bH as Nt,bI as Bt,bJ as Ht,bK as Ft,bL as Mt,bM as Rt,bN as $t,bO as jt,bP as zt,bQ as Vt,bR as Xt,bS as Qt,bT as qt,bU as Jt,bV as Kt,bW as Yt,bX as Zt,bY as te,bZ as ee,b_ as se,b$ as ae,c0 as re,c1 as ie,c2 as ne,c3 as le,c4 as ce,c5 as oe,c6 as de,c7 as ue,c8 as he,c9 as ge,ca as fe,cb as ve,cc as me,cd as pe,ce as Te,cf as be,cg as Ue,ch as Ge,ci as ye,cj as Se,ck as we,cl as Ce,cm as Ee,cn as Ae,co as Le,cp as Oe,cq as Pe,cr as ke,cs as xe,ct as De,cu as _e,cv as Ie,cw as We,aN as Ne,al as U,u as Be}from"./index-CJoUzN77.js";import{s as w,a as C}from"./settings-sync-D_TFiVOa.js";function D(t){if(!t||t.indexOf("$")===-1)return[];var e=[];return t.replace(Q,function(a,s,r,i,n,l){var c=n+s.length,o=c+i.length+1;e.push({cashtag:i,indices:[c,o]})}),e}var dt=/[-_.\/]$/,He=63,Fe="xn--",Me={toAscii:function(e){if(!(e.substring(0,4)===Fe&&!e.match(B))){for(var a=e.split("."),s=0;s<a.length;s++){var r=a[s],i=It.toASCII(r);if(i.length<1||i.length>He)return}return a.join(".")}}},Re="https://",$e={extractUrlsWithoutProtocol:!0},je=4096,ze=40,L=function(e){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:$e;if(!e||(a.extractUrlsWithoutProtocol?!e.match(/\./):!e.match(/:/)))return[];for(var s=[],r=function(){var l=RegExp.$2,c=RegExp.$3,o=RegExp.$4,d=RegExp.$5,h=RegExp.$7,p=N.lastIndex,u=p-c.length;if(!Ve(c,o||Re,d))return"continue";if(o){if(c.match(q)){var g=RegExp.$1;if(g&&g.length>ze)return"continue";c=RegExp.lastMatch,p=u+c.length}s.push({url:c,indices:[u,p]})}else{if(!a.extractUrlsWithoutProtocol||l.match(dt))return"continue";var m=null,f=0;if(d.replace(B,function(v){var b=d.indexOf(v,f);f=b+v.length,m={url:v,indices:[u+b,u+f]},s.push(m)}),m==null)return"continue";h&&(m.url=c.replace(d,m.url),m.indices[1]=p)}};N.exec(e);)var i=r();return s},Ve=function(e,a,s){var r=e.length,i=Me.toAscii(s);return!i||!i.length?!1:(r=r+i.length-s.length,a.length+r<=je)};function M(t){t.sort(function(s,r){return s.indices[0]-r.indices[0]});for(var e=t[0],a=1;a<t.length;a++)e.indices[1]>t[a].indices[0]?(t.splice(a,1),a--):e=t[a]}var _=function(e,a){if(a||(a={checkUrlOverlap:!0}),!e||!e.match(J))return[];var s=[];if(e.replace(K,function(l,c,o,d,h,p){var u=p.slice(h+l.length);if(!u.match(Y)){var m=h+c.length,f=m+d.length+1;s.push({hashtag:d,indices:[m,f]})}}),a.checkUrlOverlap){var r=L(e);if(r.length>0){var i=s.concat(r);M(i),s=[];for(var n=0;n<i.length;n++)i[n].hashtag&&s.push(i[n])}}return s};function I(t){if(!t||!t.match(H))return[];var e=[];return t.replace(Z,function(a,s,r,i,n,l,c){var o=c.slice(l+a.length);if(!o.match(F)){n=n||"";var d=l+s.length,h=d+i.length+n.length+1;e.push({screenName:i,listSlug:n,indices:[d,h]})}}),e}function ut(t,e){var a=L(t,e).concat(I(t)).concat(_(t,{checkUrlOverlap:!1})).concat(D(t));return a.length==0?[]:(M(a),a)}function k(t){var e={};for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);return e}var Xe={disabled:!0,readonly:!0,multiple:!0,checked:!0},Qe={urlClass:!0,listClass:!0,usernameClass:!0,hashtagClass:!0,cashtagClass:!0,usernameUrlBase:!0,listUrlBase:!0,hashtagUrlBase:!0,cashtagUrlBase:!0,usernameUrlBlock:!0,listUrlBlock:!0,hashtagUrlBlock:!0,linkUrlBlock:!0,usernameIncludeSymbol:!0,suppressLists:!0,suppressNoFollow:!0,targetBlank:!0,suppressDataScreenName:!0,urlEntities:!0,symbolTag:!0,textWithSymbolTag:!0,urlTarget:!0,invisibleTagAttrs:!0,linkAttributeBlock:!0,linkTextBlock:!0,htmlEscapeNonEntities:!0};function ht(t){var e={};for(var a in t){var s=t[a];Qe[a]||(Xe[a]&&(s=s?a:null),s!=null&&(e[a]=s))}return e}var qe={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#39;"};function T(t){return t&&t.replace(/[&"'><]/g,function(e){return qe[e]})}var Je={disabled:!0,readonly:!0,multiple:!0,checked:!0};function gt(t){var e="";for(var a in t){var s=t[a];Je[a]&&(s=s?a:null),s!=null&&(e+=" ".concat(T(a),'="').concat(T(s.toString()),'"'))}return e}function x(t,e,a,s){s.suppressNoFollow||(a.rel="nofollow"),s.linkAttributeBlock&&s.linkAttributeBlock(t,a),s.linkTextBlock&&(e=s.linkTextBlock(t,e));var r={text:e,attr:gt(a)};return tt("<a#{attr}>#{text}</a>",r)}function W(t,e,a,s,r){var i=r.symbolTag?"<".concat(r.symbolTag,">").concat(e,"</").concat(r.symbolTag,">"):e;a=T(a);var n=r.textWithSymbolTag?"<".concat(r.textWithSymbolTag,">").concat(a,"</").concat(r.textWithSymbolTag,">"):a;return r.usernameIncludeSymbol||!e.match(H)?x(t,i+n,s,r):i+x(t,n,s,r)}function ft(t,e,a){var s=T(t.cashtag),r=k(a.htmlAttrs||{});return r.href=a.cashtagUrlBase+s,r.title="$".concat(s),r.class=a.cashtagClass,a.targetBlank&&(r.target="_blank"),W(t,"$",s,r,a)}var vt=/[\u0600-\u06FF]|[\u0750-\u077F]|[\u0590-\u05FF]|[\uFE70-\uFEFF]/gm;function mt(t,e,a){var s=e.substring(t.indices[0],t.indices[0]+1),r=T(t.hashtag),i=k(a.htmlAttrs||{});return i.href=a.hashtagUrlBase+r,i.title="#".concat(r),i.class=a.hashtagClass,r.charAt(0).match(vt)&&(i.class+=" rtl"),a.targetBlank&&(i.target="_blank"),W(t,s,r,i,a)}function pt(t,e){var a=t.display_url,s=t.expanded_url,r=a.replace(/…/g,"");if(s.indexOf(r)!=-1){var i=s.indexOf(r),n={displayUrlSansEllipses:r,beforeDisplayUrl:s.substr(0,i),afterDisplayUrl:s.substr(i+r.length),precedingEllipsis:a.match(/^…/)?"…":"",followingEllipsis:a.match(/…$/)?"…":""};for(var l in n)n.hasOwnProperty(l)&&(n[l]=T(n[l]));return n.invisible=e.invisibleTagAttrs,tt("<span class='tco-ellipsis'>#{precedingEllipsis}<span #{invisible}>&nbsp;</span></span><span #{invisible}>#{beforeDisplayUrl}</span><span class='js-display-url'>#{displayUrlSansEllipses}</span><span #{invisible}>#{afterDisplayUrl}</span><span class='tco-ellipsis'><span #{invisible}>&nbsp;</span>#{followingEllipsis}</span>",n)}return a}var Tt=/^https?:\/\//i;function bt(t,e,a){var s=t.url,r=s,i=T(r),n=a.urlEntities&&a.urlEntities[s]||t;n.display_url&&(i=pt(n,a));var l=k(a.htmlAttrs||{});return s.match(Tt)||(s="http://".concat(s)),l.href=s,a.targetBlank&&(l.target="_blank"),a.urlClass&&(l.class=a.urlClass),a.urlTarget&&(l.target=a.urlTarget),!a.title&&n.display_url&&(l.title=n.expanded_url),x(t,i,l,a)}function Ut(t,e,a){var s=e.substring(t.indices[0],t.indices[0]+1),r=T(t.screenName),i=T(t.listSlug),n=t.listSlug&&!a.suppressLists,l=k(a.htmlAttrs||{});return l.class=n?a.listClass:a.usernameClass,l.href=n?a.listUrlBase+r+i:a.usernameUrlBase+r,!n&&!a.suppressDataScreenName&&(l["data-screen-name"]=r),a.targetBlank&&(l.target="_blank"),W(t,s,n?r+i:r,l,a)}var Ke="tweet-url list-slug",Ye="tweet-url username",Ze="tweet-url hashtag",ts="tweet-url cashtag";function S(t,e,s){var s=k(s||{});s.hashtagClass=s.hashtagClass||Ze,s.hashtagUrlBase=s.hashtagUrlBase||"https://twitter.com/search?q=%23",s.cashtagClass=s.cashtagClass||ts,s.cashtagUrlBase=s.cashtagUrlBase||"https://twitter.com/search?q=%24",s.listClass=s.listClass||Ke,s.usernameClass=s.usernameClass||Ye,s.usernameUrlBase=s.usernameUrlBase||"https://twitter.com/",s.listUrlBase=s.listUrlBase||"https://twitter.com/",s.htmlAttrs=ht(s),s.invisibleTagAttrs=s.invisibleTagAttrs||"style='position:absolute;left:-9999px;'";var r,i,n;if(s.urlEntities){for(r={},i=0,n=s.urlEntities.length;i<n;i++)r[s.urlEntities[i].url]=s.urlEntities[i];s.urlEntities=r}var l="",c=0;e.sort(function(h,p){return h.indices[0]-p.indices[0]});for(var o=s.htmlEscapeNonEntities?T:function(h){return h},i=0;i<e.length;i++){var d=e[i];l+=o(t.substring(c,d.indices[0])),d.url?l+=bt(d,t,s):d.hashtag?l+=mt(d,t,s):d.screenName?l+=Ut(d,t,s):d.cashtag&&(l+=ft(d,t,s)),c=d.indices[1]}return l+=o(t.substring(c,t.length)),l}function es(t,e){var a=ut(t,{extractUrlsWithoutProtocol:!1});return S(t,a,e)}function ss(t,e){var a=D(t);return S(t,a,e)}function as(t,e){var a=_(t);return S(t,a,e)}function rs(t,e){var a=L(t,{extractUrlsWithoutProtocol:!1});return S(t,a,e)}function is(t,e){var a=I(t);return S(t,a,e)}var Gt=function(e,a,s){if(a.length!==0){var r=0,i=0;a.sort(function(d,h){return d.indices[0]-h.indices[0]});for(var n=0,l=a[0];r<e.length;){if(l.indices[0]===(s?r:i)){var c=l.indices[1]-l.indices[0];if(l.indices[0]=s?i:r,l.indices[1]=l.indices[0]+c,n++,n===a.length)break;l=a[n]}var o=e.charCodeAt(r);o>=55296&&o<=56319&&r<e.length-1&&(o=e.charCodeAt(r+1),o>=56320&&o<=57343&&r++),i++,r++}}};function yt(t,e){Gt(t,e,!1)}function ns(t,e,a){if(e.user_mentions)for(var s=0;s<e.user_mentions.length;s++)e.user_mentions[s].screenName=e.user_mentions[s].screen_name;if(e.hashtags)for(var s=0;s<e.hashtags.length;s++)e.hashtags[s].hashtag=e.hashtags[s].text;if(e.symbols)for(var s=0;s<e.symbols.length;s++)e.symbols[s].cashtag=e.symbols[s].text;var r=[];for(var i in e)r=r.concat(e[i]);return yt(t,r),S(t,r,a)}const A={version1:{version:1,maxWeightedTweetLength:140,scale:1,defaultWeight:1,transformedURLLength:23,ranges:[]},version2:{version:2,maxWeightedTweetLength:280,scale:100,defaultWeight:200,transformedURLLength:23,ranges:[{start:0,end:4351,weight:100},{start:8192,end:8205,weight:100},{start:8208,end:8223,weight:100},{start:8242,end:8247,weight:100}]},version3:{version:3,maxWeightedTweetLength:280,scale:100,defaultWeight:200,emojiParsingEnabled:!0,transformedURLLength:23,ranges:[{start:0,end:4351,weight:100},{start:8192,end:8205,weight:100},{start:8208,end:8223,weight:100},{start:8242,end:8247,weight:100}]},defaults:{version:3,maxWeightedTweetLength:280,scale:100,defaultWeight:200,emojiParsingEnabled:!0,transformedURLLength:23,ranges:[{start:0,end:4351,weight:100},{start:8192,end:8205,weight:100},{start:8208,end:8223,weight:100},{start:8242,end:8247,weight:100}]}};function ls(t,e,a){if(e.length!=0){var s=0,r=0;e.sort(function(o,d){return o.indices[0]-d.indices[0]});for(var i=0,n=e[0];s<t.length;){if(n.indices[0]==(a?s:r)){var l=n.indices[1]-n.indices[0];if(n.indices[0]=a?r:s,n.indices[1]=n.indices[0]+l,i++,i==e.length)break;n=e[i]}var c=t.charCodeAt(s);c>=55296&&c<=56319&&s<t.length-1&&(c=t.charCodeAt(s+1),c>=56320&&c<=57343&&s++),r++,s++}}}function cs(t){for(var e=[],a=D(t),s=0;s<a.length;s++)e.push(a[s].cashtag);return e}function St(t){for(var e=[],a=_(t),s=0;s<a.length;s++)e.push(a[s].hashtag);return e}function wt(t){for(var e=[],a,s=I(t),r=0;r<s.length;r++)a=s[r],a.listSlug===""&&e.push({screenName:a.screenName,indices:a.indices});return e}function Ct(t){for(var e=[],a=wt(t),s=0;s<a.length;s++){var r=a[s].screenName;e.push(r)}return e}function os(t){if(!t)return null;var e=t.match(et);return!e||RegExp.rightContext.match(F)?null:e[1]}function ds(t,e){for(var a=[],s=L(t,e),r=0;r<s.length;r++)a.push(s[r].url);return a}var us=function(e,a){var s=a.defaultWeight,r=a.ranges,i=s,n=e.charCodeAt(0);if(Array.isArray(r))for(var l=0,c=r.length;l<c;l++){var o=r[l];if(n>=o.start&&n<=o.end){i=o.weight;break}}return i};function hs(t,e){Gt(t,e,!0)}function R(t){return st.test(t)}var gs=/^https:\/\//i,Et=function(){for(var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:A.defaults,s=Object.keys(a).length?a:A.defaults,r=s.defaultWeight,i=s.emojiParsingEnabled,n=s.scale,l=s.maxWeightedTweetLength,c=s.transformedURLLength,o=typeof String.prototype.normalize=="function"?e.normalize():e,d=$(L(o)),h=i?$(Wt.parse(o)):[],p=o.length,u=0,m=0,f=!0,g=0;g<p;g++){if(d[g]){var v=d[g],b=v.url;v.indices,u+=c*n,g+=b.length-1}else if(i&&h[g]){var G=h[g],y=G.text;G.indices,u+=r,g+=y.length-1}else g+=fs(o,g)?1:0,u+=us(o.charAt(g),s);f&&(f=!R(o.substring(g,g+1))),f&&u<=l*n&&(m=g)}u=u/n,f=f&&u>0&&u<=l;var O=Math.floor(u/l*1e3),_t=e.length-o.length;return m+=_t,{weightedLength:u,valid:f,permillage:O,validRangeStart:0,validRangeEnd:m,displayRangeStart:0,displayRangeEnd:e.length>0?e.length-1:0}},$=function(e){return e.reduce(function(a,s){return a[s.indices[0]]=s,a},{})},fs=function(e,a){if(a<e.length-1){var s=e.charCodeAt(a),r=e.charCodeAt(a+1);return 55296<=s&&s<=56319&&56320<=r&&r<=57343}return!1},At=function(e){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:A.defaults;return Et(e,a).weightedLength};function Lt(t){return t.replace(at," ").length}function Ot(t){for(var e=t.split("<"),a,s=[],r,i=0;i<e.length;i+=1)if(r=e[i],!r)s.push("");else{a=r.split(">");for(var n=0;n<a.length;n+=1)s.push(a[n])}return s}function vs(t,e,a){var s="em";if(e=e||[],a=a||{},e.length===0)return t;var r=a.tag||s,i=["<".concat(r,">"),"</".concat(r,">")],n=Ot(t),l,c,o="",d=0,h=n[0],p=0,u=0,m=!1,f=h,g=[],v,b,G,y,O;for(l=0;l<e.length;l+=1)for(c=0;c<e[l].length;c+=1)g.push(e[l][c]);for(v=0;v<g.length;v+=1){for(b=g[v],G=i[v%2],y=!1;h!=null&&b>=p+h.length;)o+=f.slice(u),m&&b===p+f.length&&(o+=G,y=!0),n[d+1]&&(o+="<".concat(n[d+1],">")),p+=f.length,u=0,d+=2,h=n[d],f=h,m=!1;!y&&h!=null?(O=b-p,o+=f.slice(u,O)+G,u=O,v%2===0?m=!0:m=!1):y||(y=!0,o+=G)}if(h!=null)for(u<f.length&&(o+=f.slice(u)),v=d+1;v<n.length;v+=1)o+=v%2===0?n[v]:"<".concat(n[v],">");return o}function P(t){"@babel/helpers - typeof";return P=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},P(t)}function ms(t,e){if(P(t)!="object"||!t)return t;var a=t[Symbol.toPrimitive];if(a!==void 0){var s=a.call(t,e);if(P(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ps(t){var e=ms(t,"string");return P(e)=="symbol"?e:e+""}function Ts(t,e,a){return(e=ps(e))in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function j(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),a.push.apply(a,s)}return a}function bs(t){for(var e=1;e<arguments.length;e++){var a=arguments[e]!=null?arguments[e]:{};e%2?j(a,!0).forEach(function(s){Ts(t,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):j(a).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(a,s))})}return t}function Pt(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:A.defaults;if(!t)return"empty";var a=bs({},A.defaults,{},e),s=a.maxWeightedTweetLength;return At(t,a)>s?"too_long":R(t)?"invalid_characters":!1}function Us(t){if(!t)return!1;var e=St(t);return e.length===1&&e[0]===t.slice(1)}function Gs(t,e){return!Pt(t,e)}var kt=/(?:[a-z][a-z0-9+\-.]*)/i;function E(t,e,a){return a?!t||t.match(e)&&RegExp["$&"]===t:typeof t=="string"&&t.match(e)&&RegExp["$&"]===t}function ys(t,e,a){if(e==null&&(e=!0),a==null&&(a=!0),!t)return!1;var s=t.match(rt);if(!s||s[0]!==t)return!1;var r=s[1],i=s[2],n=s[3],l=s[4],c=s[5];return(!a||E(r,kt)&&r.match(/^https?$/i))&&E(n,it)&&E(l,nt,!0)&&E(c,lt,!0)?e&&E(i,ct)||!e&&E(i,ot):!1}function Ss(t){if(!t)return!1;var e=Ct(t);return e.length===1&&e[0]===t.slice(1)}const ws={astralLetterAndMarks:Ie,astralNumerals:_e,atSigns:H,bmpLetterAndMarks:De,bmpNumerals:xe,cashtag:ke,codePoint:Pe,cyrillicLettersAndMarks:Oe,endHashtagMatch:Y,endMentionMatch:F,extractUrl:N,hashSigns:J,hashtagAlpha:Le,hashtagAlphaNumeric:Ae,hashtagBoundary:Ee,hashtagSpecialChars:Ce,invalidChars:st,invalidCharsGroup:we,invalidDomainChars:Se,invalidUrlWithoutProtocolPrecedingChars:dt,latinAccentChars:ye,nonBmpCodePairs:at,punct:Ge,rtlChars:vt,spaces:Ue,spacesGroup:be,urlHasHttps:gs,urlHasProtocol:Tt,validAsciiDomain:B,validateUrlAuthority:ot,validateUrlDecOctet:Te,validateUrlDomain:pe,validateUrlDomainSegment:me,validateUrlDomainTld:ve,validateUrlFragment:lt,validateUrlHost:fe,validateUrlIp:ge,validateUrlIpv4:he,validateUrlIpv6:ue,validateUrlPath:it,validateUrlPchar:de,validateUrlPctEncoded:oe,validateUrlPort:ce,validateUrlQuery:nt,validateUrlScheme:kt,validateUrlSubDelims:le,validateUrlSubDomainSegment:ne,validateUrlUnencoded:rt,validateUrlUnicodeAuthority:ct,validateUrlUnicodeDomain:ie,validateUrlUnicodeDomainSegment:re,validateUrlUnicodeDomainTld:ae,validateUrlUnicodeHost:se,validateUrlUnicodeSubDomainSegment:ee,validateUrlUnreserved:te,validateUrlUserinfo:Zt,validCashtag:Q,validCCTLD:Yt,validDomain:Kt,validDomainChars:Jt,validDomainName:qt,validGeneralUrlPathChars:Qt,validGTLD:Xt,validHashtag:K,validMentionOrList:Z,validMentionPrecedingChars:Vt,validPortNumber:zt,validPunycode:jt,validReply:et,validSubdomain:$t,validTcoUrl:q,validUrlBalancedParens:Rt,validUrlPath:Mt,validUrlPathEndingChars:Ft,validUrlPrecedingChars:Ht,validUrlQueryChars:Bt,validUrlQueryEndingChars:Nt};function Cs(t,e,a){var s=Lt(t),r=t.length-s;if(r>0){var i=Array.from(t),n=e===0?"":i.slice(0,e).join(""),l=i.slice(e,a).join("");return[n.length,n.length+l.length]}return[e,a]}const Es={autoLink:es,autoLinkCashtags:ss,autoLinkEntities:S,autoLinkHashtags:as,autoLinkUrlsCustom:rs,autoLinkUsernamesOrLists:is,autoLinkWithJSON:ns,configs:A,convertUnicodeIndices:ls,extractCashtags:cs,extractCashtagsWithIndices:D,extractEntitiesWithIndices:ut,extractHashtags:St,extractHashtagsWithIndices:_,extractHtmlAttrsFromOptions:ht,extractMentions:Ct,extractMentionsOrListsWithIndices:I,extractMentionsWithIndices:wt,extractReplies:os,extractUrls:ds,extractUrlsWithIndices:L,getTweetLength:At,getUnicodeTextLength:Lt,hasInvalidCharacters:R,hitHighlight:vs,htmlEscape:T,isInvalidTweet:Pt,isValidHashtag:Us,isValidList:We,isValidTweetText:Gs,isValidUrl:ys,isValidUsername:Ss,linkTextWithEntity:pt,linkToCashtag:ft,linkToHashtag:mt,linkToMentionAndList:Ut,linkToText:x,linkToTextWithSymbol:W,linkToUrl:bt,modifyIndicesFromUTF16ToUnicode:hs,modifyIndicesFromUnicodeToUTF16:yt,regexen:ws,removeOverlappingEntities:M,parseTweet:Et,splitTags:Ot,standardizeIndices:Cs,tagAttrs:gt};function xt(t){const e=t||"No description",a=e.match(/\[.*?\]/),s=a?a[0]:"",r=s.length>0?s.substring(1,s.length-1):"";let i=As(e),n="legacy";i.length===0&&(i=Ls(e),n=i.length>0?"twitter":"none");let l=e.substring(s.length).trim();if(n==="legacy"){const c=Dt(e).length;l=e.substring(s.length,e.length-c).trim()}else n==="twitter"&&(l=l.replace(/#\w+/g,"").replace(/\s+/g," ").trim());return{title:r,description:l,customTags:i,tagStyle:n}}function As(t){const e=Dt(t);if(!e)return[];const a="#tags:";return e.trim().startsWith(a)?e.trim().substring(a.length).split(/[,，、]/).map(i=>i.trim()).filter(i=>i.length>0):[]}function Dt(t){const e=t.match(/#tags:.*$/);return e?e[0]:""}function Ls(t){return Es.extractHashtags(t)}function z(t){const e=t||"Other",a="lang@";return e.trim().length>0?a+e.trim():a+"Other"}function xs(t){const e="lang@";return t.startsWith(e)?t.substring(e.length):t}function V(t){const e=new Set,a=t.files||{};return Object.values(a).forEach(s=>{s.language&&e.add(z(s.language))}),e.size===0&&e.add(z("Other")),Array.from(e)}function X(t){return xt(t.description).customTags}const Os=Ne("gists",{state:()=>({gists:{},loadedGistIds:new Set,loadingGistId:null,gistTags:{},pinnedTags:[],starredGistIds:new Set,starredGists:{},recentGists:[],activeGistId:null,activeTag:"All Gists",selectedGistIds:new Set,isSyncing:!1,lastSyncTime:null,syncError:null}),getters:{activeGist:t=>t.activeGistId?t.gists[t.activeGistId]:null,allGistsArray:t=>Object.values(t.gists).sort((e,a)=>new Date(a.updated_at).getTime()-new Date(e.updated_at).getTime()),gistsByTag:t=>e=>{if(e==="All Gists")return Object.values(t.gists).sort((s,r)=>new Date(r.updated_at).getTime()-new Date(s.updated_at).getTime());if(e==="Starred")return Object.values(t.starredGists).sort((s,r)=>new Date(r.updated_at).getTime()-new Date(s.updated_at).getTime());if(e==="Recent")return t.recentGists.map(s=>t.gists[s.id]||t.starredGists[s.id]).filter(Boolean);const a=t.gistTags[e]||new Set;return Array.from(a).map(s=>t.gists[s]).filter(Boolean).sort((s,r)=>new Date(r.updated_at).getTime()-new Date(s.updated_at).getTime())},recentGistsArray:t=>t.recentGists.map(e=>t.gists[e.id]||t.starredGists[e.id]).filter(Boolean),recentCount:t=>t.recentGists.filter(e=>t.gists[e.id]||t.starredGists[e.id]).length,allTags:t=>Object.keys(t.gistTags).sort(),languageTags:t=>Object.keys(t.gistTags).filter(e=>e.startsWith("lang@")).sort(),customTags:t=>Object.keys(t.gistTags).filter(e=>!e.startsWith("lang@")).sort(),tagInfo:t=>e=>{const a=t.gistTags[e];return a?{name:e,count:a.size,gistIds:Array.from(a),type:e.startsWith("lang@")?"language":"custom"}:null},totalGists:t=>Object.keys(t.gists).length,stats:t=>{const e=Object.keys(t.gistTags);return{totalGists:Object.keys(t.gists).length,totalTags:e.length,languageTags:e.filter(a=>a.startsWith("lang@")).length,customTags:e.filter(a=>!a.startsWith("lang@")).length}},starredGistsArray:t=>Object.values(t.starredGists).sort((e,a)=>new Date(a.updated_at).getTime()-new Date(e.updated_at).getTime()),starredCount:t=>t.starredGistIds.size,isStarred:t=>e=>t.starredGistIds.has(e),isGistLoaded:t=>e=>t.loadedGistIds.has(e),isGistLoading:t=>e=>t.loadingGistId===e,isGistSelected:t=>e=>t.selectedGistIds.has(e),selectedCount:t=>t.selectedGistIds.size,selectedGistsArray:t=>Array.from(t.selectedGistIds).map(e=>t.gists[e]).filter(Boolean)},actions:{async syncGists(){const t=Be();if(!t.isAuthenticated||!t.username)throw new Error("Not authenticated");this.isSyncing=!0,this.syncError=null;try{console.debug("[Gists] Starting sync...");const e=await U.getAllGists(t.username);console.debug(`[Gists] Fetched ${e.length} gists`),this.gists={},this.gistTags={},this.loadedGistIds=new Set,e.forEach(a=>{this.gists[a.id]=a,V(a).forEach(i=>{this.gistTags[i]||(this.gistTags[i]=new Set),this.gistTags[i].add(a.id)}),X(a).forEach(i=>{this.gistTags[i]||(this.gistTags[i]=new Set),this.gistTags[i].add(a.id)})}),this.lastSyncTime=Date.now(),w.buildIndex(this.gists),console.debug("[Gists] Sync completed successfully")}catch(e){throw console.error("[Gists] Sync failed:",e),this.syncError=e instanceof Error?e.message:"Sync failed",e}finally{this.isSyncing=!1}},async fetchGistContent(t){if(this.loadedGistIds.has(t))return this.gists[t]||null;if(this.loadingGistId===t)return this.gists[t]||null;this.loadingGistId=t;try{console.debug(`[Gists] Fetching full content for gist ${t}`);const e=await U.getSingleGist(t);return this.gists[t]=e,this.loadedGistIds.add(t),w.updateInIndex(e),console.debug(`[Gists] Loaded full content for gist ${t}`),e}catch(e){return console.error(`[Gists] Failed to fetch gist ${t}:`,e),null}finally{this.loadingGistId=null}},trackRecentGist(t){this.recentGists=this.recentGists.filter(a=>a.id!==t),this.recentGists.unshift({id:t,viewedAt:Date.now()}),this.recentGists.length>10&&(this.recentGists=this.recentGists.slice(0,10)),C.saveSettings({recentGists:this.recentGists})},async createGist(t,e,a=!0){try{console.debug("[Gists] Creating new gist");const s=await U.createGist(t,e,a);return this.gists[s.id]=s,this.loadedGistIds.add(s.id),this.indexGistTags(s),w.addToIndex(s),console.debug("[Gists] Gist created:",s.id),s}catch(s){throw console.error("[Gists] Create failed:",s),s}},async updateGist(t,e,a){try{console.debug("[Gists] Updating gist:",t);const s=await U.updateGist(t,e,a);return this.removeGistFromTags(t),this.gists[t]=s,this.loadedGistIds.add(t),this.indexGistTags(s),w.updateInIndex(s),console.debug("[Gists] Gist updated:",t),s}catch(s){throw console.error("[Gists] Update failed:",s),s}},async deleteGist(t){try{console.debug("[Gists] Deleting gist:",t),await U.deleteGist(t),this.removeGistFromTags(t),delete this.gists[t],w.removeFromIndex(t),this.activeGistId===t&&(this.activeGistId=null),console.debug("[Gists] Gist deleted:",t)}catch(e){throw console.error("[Gists] Delete failed:",e),e}},setActiveGist(t){this.activeGistId=t},setActiveTag(t){this.activeTag=t,C.saveSettings({activeTag:t})},togglePinnedTag(t){const e=this.pinnedTags.indexOf(t);e>-1?this.pinnedTags.splice(e,1):this.pinnedTags.push(t),C.saveSettings({pinnedTags:[...this.pinnedTags]})},pinTag(t){this.pinnedTags.includes(t)||(this.pinnedTags.push(t),C.saveSettings({pinnedTags:[...this.pinnedTags]}))},unpinTag(t){const e=this.pinnedTags.indexOf(t);e>-1&&(this.pinnedTags.splice(e,1),C.saveSettings({pinnedTags:[...this.pinnedTags]}))},reorderPinnedTags(t){this.pinnedTags=t,C.saveSettings({pinnedTags:[...this.pinnedTags]})},indexGistTags(t){V(t).forEach(s=>{this.gistTags[s]||(this.gistTags[s]=new Set),this.gistTags[s].add(t.id)}),X(t).forEach(s=>{this.gistTags[s]||(this.gistTags[s]=new Set),this.gistTags[s].add(t.id)})},removeGistFromTags(t){Object.keys(this.gistTags).forEach(e=>{this.gistTags[e].delete(t),this.gistTags[e].size===0&&delete this.gistTags[e]})},getGistTitle(t){const e=this.gists[t];return e?xt(e.description).title||e.description||"Untitled":""},async syncStarredGists(){try{console.debug("[Gists] Syncing starred gists...");const t=await U.getStarredGists();this.starredGistIds=new Set(t.map(e=>e.id)),this.starredGists={},t.forEach(e=>{this.starredGists[e.id]=e}),console.debug(`[Gists] Synced ${t.length} starred gists`)}catch(t){throw console.error("[Gists] Failed to sync starred gists:",t),t}},async starGist(t){try{console.debug("[Gists] Starring gist:",t),await U.starGist(t),this.starredGistIds.add(t);const e=this.gists[t];e&&(this.starredGists[t]=e),console.debug("[Gists] Gist starred:",t)}catch(e){throw console.error("[Gists] Failed to star gist:",e),e}},async unstarGist(t){try{console.debug("[Gists] Unstarring gist:",t),await U.unstarGist(t),this.starredGistIds.delete(t),delete this.starredGists[t],console.debug("[Gists] Gist unstarred:",t)}catch(e){throw console.error("[Gists] Failed to unstar gist:",e),e}},async toggleStar(t){this.starredGistIds.has(t)?await this.unstarGist(t):await this.starGist(t)},toggleGistSelection(t){this.selectedGistIds.has(t)?this.selectedGistIds.delete(t):this.selectedGistIds.add(t)},selectGist(t){this.selectedGistIds.add(t)},deselectGist(t){this.selectedGistIds.delete(t)},selectAllGists(t){t.forEach(e=>this.selectedGistIds.add(e))},deselectAllGists(){this.selectedGistIds.clear()},async bulkDeleteGists(t){const e=[],a=[];for(const s of t)try{await this.deleteGist(s),e.push(s),this.selectedGistIds.delete(s)}catch{a.push(s)}return{success:e,failed:a}},$reset(){this.gists={},this.loadedGistIds=new Set,this.loadingGistId=null,this.gistTags={},this.pinnedTags=[],this.starredGistIds=new Set,this.starredGists={},this.recentGists=[],this.activeGistId=null,this.activeTag="All Gists",this.selectedGistIds=new Set,this.isSyncing=!1,this.lastSyncTime=null,this.syncError=null,w.resetIndex(),console.debug("[Gists] Store reset")}},persist:{paths:["pinnedTags","lastSyncTime","activeTag","recentGists"]}}),Ds=Object.freeze(Object.defineProperty({__proto__:null,useGistsStore:Os},Symbol.toStringTag,{value:"Module"}));export{xt as a,Ds as g,xs as p,Os as u};
