import{aN as l}from"./index-CJoUzN77.js";import{a,s as t}from"./settings-sync-D_TFiVOa.js";const c=l("search",{state:()=>({query:"",results:[],isSearching:!1,savedSearches:[],filters:{visibility:"all",languages:[],dateRange:"all"}}),getters:{isActive:e=>e.query.trim().length>0,isRegexQuery:e=>t.isRegexQuery(e.query),isValidRegex:e=>t.isRegexQuery(e.query)?t.parseRegex(e.query)!==null:!0,resultCount:e=>e.results.length,hasResults:e=>e.results.length>0,hasNoResults:e=>e.query.trim().length>0&&e.results.length===0,isCurrentQuerySaved:e=>{const s=e.query.trim().toLowerCase();return e.savedSearches.some(r=>r.query.toLowerCase()===s)},sortedSavedSearches:e=>[...e.savedSearches].sort((s,r)=>r.createdAt-s.createdAt),hasActiveFilters:e=>e.filters.visibility!=="all"||e.filters.languages.length>0||e.filters.dateRange!=="all",activeFilterCount:e=>{let s=0;return e.filters.visibility!=="all"&&s++,e.filters.languages.length>0&&(s+=e.filters.languages.length),e.filters.dateRange!=="all"&&s++,s}},actions:{search(e){this.query=e,this.isSearching=!0;try{if(!e||e.trim().length===0){this.results=[];return}this.results=t.search(e),console.debug(`[Search] Query "${e}" returned ${this.results.length} results`)}catch(s){console.error("[Search] Search failed:",s),this.results=[]}finally{this.isSearching=!1}},clearSearch(){this.query="",this.results=[],this.isSearching=!1,console.debug("[Search] Search cleared")},setQuery(e){this.query=e},getResult(e){return this.results[e]||null},saveSearch(e){const s=this.query.trim();if(!s||s.length<2)return;if(this.isCurrentQuerySaved){console.debug("[Search] Query already saved");return}const r={id:crypto.randomUUID(),query:s,name:e||s,createdAt:Date.now()};this.savedSearches.push(r),a.saveSettings({savedSearches:[...this.savedSearches]}),console.debug(`[Search] Saved search: "${s}"`)},deleteSavedSearch(e){const s=this.savedSearches.findIndex(r=>r.id===e);s!==-1&&(this.savedSearches.splice(s,1),a.saveSettings({savedSearches:[...this.savedSearches]}),console.debug(`[Search] Deleted saved search: ${e}`))},applySavedSearch(e){const s=this.savedSearches.find(r=>r.id===e);s&&(this.search(s.query),console.debug(`[Search] Applied saved search: "${s.query}"`))},renameSavedSearch(e,s){const r=this.savedSearches.find(i=>i.id===e);r&&(r.name=s.trim()||r.query,a.saveSettings({savedSearches:[...this.savedSearches]}),console.debug(`[Search] Renamed saved search: ${e} -> "${r.name}"`))},setVisibilityFilter(e){this.filters.visibility=e,console.debug(`[Search] Visibility filter: ${e}`)},toggleLanguageFilter(e){const s=this.filters.languages.indexOf(e);s===-1?this.filters.languages.push(e):this.filters.languages.splice(s,1),console.debug(`[Search] Language filters: ${this.filters.languages.join(", ")}`)},removeLanguageFilter(e){const s=this.filters.languages.indexOf(e);s!==-1&&this.filters.languages.splice(s,1)},setDateRangeFilter(e){this.filters.dateRange=e,console.debug(`[Search] Date range filter: ${e}`)},clearFilters(){this.filters.visibility="all",this.filters.languages=[],this.filters.dateRange="all",console.debug("[Search] Filters cleared")},$reset(){this.query="",this.results=[],this.isSearching=!1,this.savedSearches=[],this.filters={visibility:"all",languages:[],dateRange:"all"},console.debug("[Search] Store reset")}},persist:{paths:["savedSearches","filters"]}});export{c as useSearchStore};
